!function(){"use strict";function e(e,t){t.otherwise(""),e.state("signin",{url:"",templateUrl:"app/views/signin.tmpl.html",controller:"UserController",controllerAs:"userVm"}).state("movies",{url:"/movies",templateUrl:"app/views/movies.tmpl.html",controller:"MovieController",controllerAs:"movieVm"}).state("movie-details",{url:"/movie-details/:title",templateUrl:"app/views/movie-details.tmpl.html",controller:"MovieDetailController",controllerAs:"movieDetailVm"})}angular.module("cinema-flix",["ui.router","ui.bootstrap","angularMoment","ngStorage","ngMessages","ngAnimate"]).config(e),e.$inject=["$stateProvider","$urlRouterProvider"]}(),function(){"use strict";function e(e,t,n){function o(t,o){return e.get(n.API_END_POINT+"/users/"+t+"/"+o).then(r,l)}function i(t){return e.post(n.API_END_POINT+"/users/",t).then(r,l)}function r(e){return e.data}function l(e){return t.reject(e.status)}var s=this;s.signIn=o,s.signUp=i}angular.module("cinema-flix").service("userService",e),e.$inject=["$http","$q","CONFIG"]}(),function(){"use strict";function e(e,t,n){function o(){return e.get(n.API_END_POINT+"/movies").then(a,c)}function i(t){return e["delete"](n.API_END_POINT+"/movies/"+t).then(a,c)}function r(t,o){return e.put(n.API_END_POINT+"/movies/"+t,o).then(a,c)}function l(t){return e.get(n.API_END_POINT+"/movies/"+t).then(a,c)}function s(t,o){return e.put(n.API_END_POINT+"/movies/"+t+"/"+o).then(a,c)}function u(t){return e.post(n.API_END_POINT+"/movies/",t).then(a,c)}function a(e){return e.data}function c(e){return t.reject(e.status)}var m=this;m.getMovies=o,m.deleteMovie=i,m.updateMovie=r,m.addMovie=u,m.getMovie=l,m.updateRating=s}angular.module("cinema-flix").service("movieService",e),e.$inject=["$http","$q","CONFIG"]}(),function(){"use strict";function e(e,t,n){function o(){return e.get(n.API_END_POINT+"/comments").then(r,l)}function i(t){return e.post(n.API_END_POINT+"/comments/",t).then(r,l)}function r(e){return e.data}function l(e){return t.reject(e.status)}var s=this;s.getComments=o,s.addComment=i}angular.module("cinema-flix").service("commentService",e),e.$inject=["$http","$q","CONFIG"]}(),function(){"use strict";function e(e,t,n){function o(o){o&&e.signIn(r.email,r.password).then(function(e){r.$storage=n.$default({user:e}),t.go("movies")},function(e){r.userNotFound=!0})}function i(o){o&&(r.newUser.role="USER",e.signUp(r.newUser).then(function(e){r.newUser=null,r.$storage=n.$default({user:e}),t.go("movies")},function(e){r.userAlreadyExists=!0}))}var r=this;r.userNotFound=!1,r.userAlreadyExists=!1,r.signIn=o,r.signUp=i,delete n.user}angular.module("cinema-flix").controller("UserController",e),e.$inject=["userService","$state","$sessionStorage"]}(),function(){"use strict";function e(e,t,n,o){function i(){null==d.user?t.go("signin"):r()}function r(){e.getMovies().then(function(e){d.movies=e,d.length=e.length,d.currentPage=1,l()},function(e){console.log(e)})}function l(){"ADMIN"===d.user.role&&(d.deleteFlag=!0,d.addFlag=!0,d.updateFlag=!0,d.itemsPerPage=7)}function s(){1==d.currentPage?"ADMIN"===d.user.role&&(d.addFlag=!0,d.itemsPerPage=7):(d.itemsPerPage=8,d.addFlag=!1)}function u(e){d.sortKey=e,d.reverse=!1}function a(){d.reverse=!d.reverse}function c(e){var t=o.open({templateUrl:"app/views/delete-movie.tmpl.html",controller:"ModalController as modalVm",resolve:{movie:function(){return e}}});t.result.then(function(){r()})}function m(e){var t=o.open({templateUrl:"app/views/update-movie.tmpl.html",controller:"ModalController as modalVm",resolve:{movie:function(){return e}}});t.result.then(function(){r()})}function v(e){var t=o.open({templateUrl:"app/views/add-movie.tmpl.html",controller:"ModalController as modalVm",resolve:{movie:function(){return e}}});t.result.then(function(){r()})}var d=this;d.sort=u,d.sortOrderChange=a,d.user=n.user,d.loginCheck=i,d.itemsPerPage=8,d.pageChanged=s,d.deleteFlag=!1,d.updateFlag=!1,d.addFlag=!1,d.showModal=!1,d.showAdminPriveleges=l,d.deleteMovie=c,d.updateMovie=m,d.addMovie=v,i()}angular.module("cinema-flix").controller("MovieController",e),e.$inject=["movieService","$state","$sessionStorage","$uibModal"]}(),function(){"use strict";function e(e,t,n,o,i){function r(){null==m.user?e.go("signin"):l()}function l(){n.getMovie(m.title).then(function(e){m.movie=e,s()},function(t){console.log(t),e.go("movies"),alert("Movie Not Found")})}function s(){o.getComments().then(function(e){m.comments=e},function(e){console.log(e)})}function u(){m.newComment.movie=m.movie,m.newComment.user=m.user,m.newComment.timestamp=new Date,o.addComment(m.newComment).then(function(e){m.newComment=null,s()},function(e){console.log(e)})}function a(){n.updateRating(m.movie.movieID,m.movie.rating).then(function(e){},function(e){console.log(e)})}function c(){m.commentsFlag=!m.commentsFlag}var m=this;m.title=t.title,m.user=i.user,m.updateRating=a,m.commentsFlag=!0,m.showComments=c,m.addComment=u,r()}angular.module("cinema-flix").controller("MovieDetailController",e),e.$inject=["$state","$stateParams","movieService","commentService","$sessionStorage"]}(),function(){"use strict";function e(e,t,n,o){function i(){null!=m.movie&&(m.movie.released=new Date(m.movie.released))}function r(){m.movie.released=null}function l(){m.popup.opened=!0}function s(){n.deleteMovie(m.movie.movieID).then(function(e){c()},function(e){m.movieNotFound=!0})}function u(e){e&&(m.movie.released=o("date")(m.movie.released,"dd MMM yyyy"),n.updateMovie(m.movie.movieID,m.movie).then(function(e){c()},function(e){console.log(e),404==e?m.movieNotFound=!0:m.movieAlreadyExists=!0}))}function a(e){e&&(m.movie.released=o("date")(m.movie.released,"dd MMM yyyy"),n.addMovie(m.movie).then(function(e){c()},function(e){m.movieAlreadyExists=!0}))}function c(){e.close()}var m=this;m.movie=t,m.close=c,m.movieAlreadyExists=!1,m.movieNotFound=!1,m.format="dd MMM yyyy",m.altInputFormats=["M!/d!/yyyy"],m.deleteMovie=s,m.updateMovie=u,m.addMovie=a,m.clear=r,m.open=l,m.popup={opened:!1},m.dateOptions={dateDisabled:!1,formatYear:"yyyy",maxDate:new Date(2020,5,22),minDate:new Date(1500,5,22),startingDay:1,showWeeks:!1},i()}angular.module("cinema-flix").controller("ModalController",e),e.$inject=["$uibModalInstance","movie","movieService","$filter"]}(),function(){"use strict";function e(e,t){function n(){t.go("movies")}function o(){delete e.user,t.go("signin")}var i=this;i.signOut=o,i.home=n}angular.module("cinema-flix").controller("HeaderController",e),e.$inject=["$sessionStorage","$state"]}(),function(){"use strict";angular.module("cinema-flix").constant("CONFIG",{API_END_POINT:"http://localhost:8080/cinema-flix/api"})}();